{% extends "base.html" %}

{% block title %}
Settings | ScrapeScout
{% endblock %}

{% block content %}
<div class="settings-container">
    <div class="settings-header">
        <h1><i class="fa fa-gear"></i> Settings</h1>
        <p class="subtitle">Customize your ScrapeScout experience</p>
    </div>

    <div class="settings-content">
        <div class="settings-section">
            <h2>Appearance</h2>
            <form class="settings-form" method="POST" action="{{ url_for('update_appearance') }}">
                {{ appearance_form.hidden_tag() }}

                <div class="setting-group">
                    <label class="setting-label">Theme</label>
                    <div class="theme-options">
                        <label class="theme-option">
                            <input type="radio" name="theme" value="light" {% if current_theme=='light' %}checked{%
                                endif %}>
                            <span class="theme-preview light">
                                <i class="fa fa-sun"></i>
                                <span>Light</span>
                            </span>
                        </label>
                        <label class="theme-option">
                            <input type="radio" name="theme" value="dark" {% if current_theme=='dark' %}checked{% endif
                                %}>
                            <span class="theme-preview dark">
                                <i class="fa fa-moon"></i>
                                <span>Dark</span>
                            </span>
                        </label>
                        <label class="theme-option">
                            <input type="radio" name="theme" value="system" {% if current_theme=='system' %}checked{%
                                endif %}>
                            <span class="theme-preview system">
                                <i class="fa fa-desktop"></i>
                                <span>System</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="setting-group">
                    <label class="setting-label">Font Size</label>
                    <div class="font-size-slider">
                        <input type="range" name="font_size" min="12" max="18" value="{{ current_font_size }}"
                            class="slider">
                        <div class="font-size-preview" style="font-size: {{ current_font_size }}px">
                            Preview Text
                        </div>
                    </div>
                </div>

                <button type="submit" class="save-button">
                    <i class="fa fa-save"></i> Save Appearance Settings
                </button>
            </form>
        </div>

        <div class="settings-section">
            <h2>Job Search Preferences</h2>
            <form class="settings-form" method="POST" action="{{ url_for('update_search_preferences') }}">
                {{ search_form.hidden_tag() }}

                <div class="setting-group">
                    <label class="setting-label">Default Job Location</label>
                    <select name="default_location" class="form-control">
                        {% for location in locations %}
                        <option value="{{ location.id }}" {% if location.id==current_location %}selected{% endif %}>
                            {{ location.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="setting-group">
                    <label class="setting-label">Default Jobs Per Page</label>
                    <select name="jobs_per_page" class="form-control">
                        <option value="10" {% if jobs_per_page==10 %}selected{% endif %}>10</option>
                        <option value="20" {% if jobs_per_page==20 %}selected{% endif %}>20</option>
                        <option value="30" {% if jobs_per_page==30 %}selected{% endif %}>30</option>
                        <option value="50" {% if jobs_per_page==50 %}selected{% endif %}>50</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label class="setting-label">Default Sort Order</label>
                    <select name="sort_order" class="form-control">
                        <option value="newest" {% if sort_order=='newest' %}selected{% endif %}>Newest First</option>
                        <option value="oldest" {% if sort_order=='oldest' %}selected{% endif %}>Oldest First</option>
                        <option value="relevance" {% if sort_order=='relevance' %}selected{% endif %}>Most Relevant
                        </option>
                    </select>
                </div>

                <button type="submit" class="save-button">
                    <i class="fa fa-save"></i> Save Search Preferences
                </button>
            </form>
        </div>

        <div class="settings-section">
            <h2>Privacy Settings</h2>
            <form class="settings-form" method="POST" action="{{ url_for('update_privacy') }}">
                {{ privacy_form.hidden_tag() }}

                <div class="setting-group">
                    <label class="toggle">
                        <input type="checkbox" name="profile_visibility" {% if profile_visible %}checked{% endif %}>
                        <span class="toggle-label">Public Profile</span>
                        <span class="toggle-description">Allow other users to view your profile</span>
                    </label>
                </div>

                <div class="setting-group">
                    <label class="toggle">
                        <input type="checkbox" name="activity_visibility" {% if activity_visible %}checked{% endif %}>
                        <span class="toggle-label">Activity Visibility</span>
                        <span class="toggle-description">Show your job search activity to other users</span>
                    </label>
                </div>

                <div class="setting-group">
                    <label class="toggle">
                        <input type="checkbox" name="data_collection" {% if data_collection_enabled %}checked{% endif
                            %}>
                        <span class="toggle-label">Data Collection</span>
                        <span class="toggle-description">Allow us to collect usage data to improve our service</span>
                    </label>
                </div>

                <button type="submit" class="save-button">
                    <i class="fa fa-save"></i> Save Privacy Settings
                </button>
            </form>
        </div>

        <div class="settings-section danger-zone">
            <h2>Danger Zone</h2>
            <div class="danger-actions">
                <button class="danger-button" onclick="confirmDeleteAccount()">
                    <i class="fa fa-trash"></i> Delete Account
                </button>
                <button class="danger-button" onclick="confirmExportData()">
                    <i class="fa fa-download"></i> Export Data
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    function confirmDeleteAccount() {
        if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
            window.location.href = "{{ url_for('delete_account') }}";
        }
    }

    function confirmExportData() {
        if (confirm('Do you want to export all your data? This may take a few moments.')) {
            window.location.href = "{{ url_for('export_data') }}";
        }
    }
</script>
{% endblock %}